(()=>{"use strict";function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function t(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var r=function(){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),this.$form=e,this.formId=e.dataset.id,this._init()}var r,n;return r=t,n=[{key:"_getHubspotCookie",value:function(){var e="; ".concat(document.cookie).split("; hubspotutk=");if(2===e.length)return e.pop().split(";").shift()}},{key:"_init",value:function(){var e=this,r=this.$form.querySelector(".acure-blue-form__consent");r&&(this.consent={$el:r,$parent:r.parentNode.parentNode},this.consent.$error=document.createElement("div"),this.consent.$error.className="acure-blue-form__item-error",this.consent.$parent.appendChild(this.consent.$error),this.consent.$error.innerText=t.VALIDATION_RULES.NOT_EMPTY.error,this.consent.setError=function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];t?e.consent.$parent.classList.add("error"):e.consent.$parent.classList.remove("error")},this.consent.$el.addEventListener("change",(function(){e.consent.setError(!1)}))),this.fields=Array.prototype.map.call(this.$form.querySelectorAll(".acure-blue-form__text-input"),(function(e){var r=e.classList.contains("acure-blue-form__text-input--required"),n=e.dataset.validate,o=n?n.split("-").map((function(e){return t.VALIDATION_RULES[e]})):[],i={$el:e,$parent:e.parentNode,name:e.getAttribute("name"),required:r};return i.$error=document.createElement("div"),i.$error.className="acure-blue-form__item-error",i.$parent.appendChild(i.$error),i.setError=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1?arguments[1]:void 0;e?(t&&(i.$error.innerText=t),i.$parent.classList.add("error")):i.$parent.classList.remove("error")},i.validate=function(){var e=!0,n=[],a=t.VALIDATION_RULES.NOT_EMPTY.validate(i.$el.value);return r&&!a&&(e=!1,n.push(t.VALIDATION_RULES.NOT_EMPTY.error)),o.forEach((function(t){t.validate(i.$el.value)||!r&&!a||(e=!1,n.push(t.error))})),e||i.setError(!0,n[0]),e},i.$el.addEventListener("input",(function(){i.setError(!1)})),i})),this.button=this.$form.querySelector('.acure-button[type="submit"]'),this.$formError=document.createElement("div"),this.$formError.className="acure-blue-form__item-error",this.$formError.innerText="An error occurred. Please try again later.",this.button.parentNode.appendChild(this.$formError),this.$form.addEventListener("submit",(function(t){t.preventDefault(),e._submitForm()}))}},{key:"_parseErrors",value:function(e){var t=new RegExp("(?<=Error in 'fields.)(.*)(?=')"),r=[];return e.forEach((function(e){var n=e.message.match(t);if(n&&n[0]){var o=n[0],i=e.message.split(o+"'.")[1];r.push({name:o,message:i})}})),r}},{key:"_setErrors",value:function(e){var t=this,r=!1;return e.forEach((function(e){var n=t.fields.find((function(t){return t.name===e.name}));n&&(n.setError(!0,e.message),r=!0)})),r}},{key:"_checkConsent",value:function(){if(this.consent){var e=this.consent.$el.checked;return this.consent.setError(!e),this.consent.$el.checked}return!0}},{key:"_validateForm",value:function(){var e=!0;return this.fields.forEach((function(t){t.validate()||(e=!1)})),this._checkConsent()||(e=!1),e}},{key:"_submitForm",value:function(){var e=this;if(this.button.parentNode.classList.remove("error"),this._validateForm()){var r="https://api.hsforms.com/submissions/v3/integration/submit/".concat(t.HUBSPOT_ID,"/").concat(this.formId),n=new XMLHttpRequest,o={fields:[],legalConsentOptions:{consent:{consentToProcess:!0,text:"I agree to receive marketing communications from Acure."}},context:{hutk:this._getHubspotCookie(),pageUri:window.location.href,pageName:document.title}};o.fields=this.fields.map((function(e){return{name:e.$el.name,value:e.$el.value}})),this.button.classList.add("acure-button--disabled"),n.open("POST",r),n.setRequestHeader("Accept","application/json"),n.setRequestHeader("Content-Type","application/json"),n.onload=function(){var t=JSON.parse(n.response);if("error"===t.status){var r=e._parseErrors(t.errors||[]),o=!1;r.length&&(o=e._setErrors(r)),o||e.button.parentNode.classList.add("error")}else t.redirectUri&&(window.location=t.redirectUri);e.button.classList.remove("acure-button--disabled")},n.send(JSON.stringify(o))}}}],n&&e(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),t}();t(r,"HUBSPOT_ID","21653852"),t(r,"VALIDATION_RULES",{PHONE:{error:"Must contain only numbers, +()-. and x.",validate:function(e){return/^\+?(((?:\(x?\d+\))|(?:x?\d+))[\-\.]?)+$/.test(e)}},EMAIL:{error:"Email must be formatted correctly.",validate:function(e){return/^[a-zA-Z0-9.\-_]{1,}@[a-zA-Z0-9.\-_]{1,}\.[a-zA-Z0-9.\-_]{2,10}$/.test(e)}},NOT_EMPTY:{error:"Please complete this required field.",validate:function(e){return Boolean(e.trim().length)}}});document.addEventListener("DOMContentLoaded",(function(){document.querySelectorAll(".acure-blue-form").forEach((function(e){new r(e)}))}))})();